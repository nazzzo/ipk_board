{% extends "layout/layout.html" %}{% block content %}
<script src="https://cdn.jsdelivr.net/npm/marked@3.0.7/marked.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/he@1.2.0/he.min.js"></script>
<script src="https://uicdn.toast.com/editor/latest/toastui-editor-all.min.js"></script>
<link rel="stylesheet" href="https://uicdn.toast.com/editor/latest/toastui-editor.min.css" />
<link rel="stylesheet" href="/css/board/view.css" />
<input type="hidden" name="nowme" id="nowme" value="{{user.userid}}" />
<div id="viewwrap">
    <div id="board">
        <div id="boardSubject">
            <h2>{{data.subject}}</h2>
        </div>
        <div id="boardInfo">
            <span id="userid">{{data.userid}}</span><span id="date" class="innerText">{{data.createdAt.slice(0,-5).split('T').join(".").split(':').join(".")}}</span
            ><span> 조회수 = {{data.hit}} </span>{% if user.userid === data.userid %} <span><a href="/board/{{user.userid}}/{{data.id}}/modify">수정</a></span>
            <span class="delete"><a href="/board/{{user.userid}}/{{data.id}}/delete">삭제</a></span
            >{% endif %}
        </div>
        <div id="hashs">{{data.tagname}}</div>
        <div id="contents">
            <div id="likes">
                <div class="img">
                    <iconify-icon class="like" icon="mdi:cards-heart"></iconify-icon>
                </div>
                <p>{{data.likeCount}}</p>
                <input type="hidden" class="likewho" value="{{data.likeidlist}}" />
            </div>
            <!-- <textarea id="boardcontent" readonly>{{data.content}}</textarea> -->
            <div id="boardcontent">
                <span id="parsedText"></span>
            </div>
        </div>
    </div>
    <div id="profile">
        <div id="img">
            <img src="{{data.userImg}}" alt="" />
        </div>
        <div id="writerInfo">
            <p id="pWriter">{{data.nickname}}</p>
            <p id="pblog"><a href="http://localhost:3005/board/{{data.userid}}">{{data.nickname}}.LOG</a></p>
        </div>
    </div>
    <div id="comments">
        <div id="total">
            <h3>{{data.commentCount}} 개의 댓글이 있습니다</h3>
        </div>
        <form method="post" action="" id="commentfrm">
            <div id="commentFrmInput">
                <input type="hidden" name="parentid" />
                <input type="text" name="comment" id="comment" placeholder="댓글을 입력해주세요" />
            </div>
            <button type="submit">댓글 등록</button>
        </form>
        <div id="temp">
            <ul>
                {% for item in comment %} {% if item.depth === 0 %}
                <li id="commentContent" data-index="{{item.id}}">
                    <div class="writeData">
                        <span id="commentUser" class="writer">{{item.userid}}</span>
                        <span id="commnetDate" class="innerText writer">{{item.createdAt.slice(0,-5).split('T').join(".").split(':').join(".")}}</span>
                    </div>
                    <input type="text" class="commentContent" value="{{item.content}}" disabled />
                    <div id="btns">
                        {% if item.userid === user.userid %}
                        <button id="updateBtn" class="commentBtn">수정</button>
                        <button id="deleteBtn" class="commentBtn">삭제</button>
                        {% endif %}
                    </div>
                    <div id="recommentBox">
                        <span id="commentRecomment">➕답글달기</span>
                    </div>
                </li>
                {% else %}
                <li id="commentContent" class="child" data-index="{{item.id}}">
                    <div class="writeData">
                        <span id="commentUser" class="writer">{{item.userid}}</span>
                        <span id="commnetDate" class="innerText writer">{{item.createdAt.slice(0,-5).split('T').join(".").split(':').join(".")}}</span>
                    </div>
                    <input type="text" class="commentContent" value="{{item.content}}" disabled />
                    <div id="btns">
                        {% if item.userid === user.userid %}
                        <button id="updateBtn" class="commentBtn">수정</button>
                        <button id="deleteBtn" class="commentBtn">삭제</button>
                        {% endif %}
                    </div>
                </li>
                {% endif %} {% endfor %}
            </ul>
        </div>
        <template id="commentList">
            <ul>
                <li id="commentContent">{{content}}1</li>
                <li id="commentWriter">{{writer}}2</li>
                <li id="commnetDate">{{regesterdate}}3</li>
                <span id="commentRecomment">댓글달기</span>
            </ul>
        </template>
        <template id="comentBtns">
            <span id="commentRe">수정</span>
            <span id="commentDelete">삭제</span>
        </template>
    </div>
</div>
<script>
    const Editor = toastui.Editor;
    const editor = new Editor({
        el: document.querySelector("#boardcontent"),
        height: "auto",
        initialEditType: "markdown",
        previewStyle: "horizontal",
        theme: "dark",
    });
    document.querySelector(".ProseMirror").innerHTML = he.decode("{{data.content}}");
    document.querySelector(".toastui-editor-toolbar").style.display = "none";
    document.querySelector(".md-mode").style.display = "none";
    document.querySelector(".toastui-editor-mode-switch").style.display = "none";
    const mdViewer = document.querySelector(".toastui-editor-md-preview");
    const mdContent = document.querySelector(".toastui-editor-contents");
    mdContent.style.width = "100%";
    mdViewer.style.background = "#fff";
</script>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script type="module" src="/js/lib/request.js"></script>
<script type="module" src="/js/lib/timestamp.js"></script>
<script type="module" src="/js/module/board/view.js"></script>
{% endblock %}

